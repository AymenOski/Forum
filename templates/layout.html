<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/layout.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
    <title>Forum</title>
</head>

<body>

    <!-- NavBar section -->
    <input type="radio" id="theme-pink" name="theme" class="theme-radio">
    <input type="radio" id="theme-aqua" name="theme" class="theme-radio">
    <input type="radio" id="theme-forest" name="theme" class="theme-radio">
    <input type="radio" id="theme-dark" name="theme" class="theme-radio" checked>

    <header class="navbar">
        <div id="in-logo">
            <div class="logo-box">Forum</div>
            <a href="/"></a>
        </div>
        <nav class="nav-links">
            <div class="auth-buttons">
                <a href="/login">Login</a>
                <a href="/signup">Register</a>
            </div>
            <div class="themes">

                <div class="theme-buttons">
                    <label for="theme-pink">üå∏</label>
                    <label for="theme-aqua">üåä</label>
                    <label for="theme-forest">üå≤</label>
                    <label for="theme-dark">üåô</label>
                </div>
            </div>
        </nav>
    </header>

    <main>

        <!-- Filtering and Posting section -->

        <div class="post-toggle-wrapper">


            <input type="radio" name="post-toggle" id="show-filter" checked hidden>
            <input type="radio" name="post-toggle" id="show-create" hidden>


            <div class="toggle-buttons">
                <label for="show-filter">üîç Filter Posts</label>
                <label for="show-create">‚ûï Make a Post</label>
            </div>

            {{if .form_error}}
            <input type="checkbox" id="error-create-post" class="error-toggle" checked hidden>
            <div class="error-popout">
                <label for="error-create-post" class="error-close">x</label>
                <p class="error-message">{{.form_error}}</p>
            </div>
            {{end}}

            <div class="post-sections">
                <div class="post-section filter-section">
                    <form method="GET" action="/filter">
                        <div class="filter-options">
                            <h4>Filter by Categories:</h4>
                            <div class="category-tags-filter">
                                <label class="category-tag">
                                    <input type="checkbox" name="category-filter[]" value="tech">
                                    <span>Technology</span>
                                </label>
                                <label class="category-tag">
                                    <input type="checkbox" name="category-filter[]" value="gaming">
                                    <span>Gaming</span>
                                </label>
                                <label class="category-tag">
                                    <input type="checkbox" name="category-filter[]" value="science">
                                    <span>Science</span>
                                </label>
                                <label class="category-tag">
                                    <input type="checkbox" name="category-filter[]" value="art">
                                    <span>Art & Creativity</span>
                                </label>
                                <label class="category-tag">
                                    <input type="checkbox" name="category-filter[]" value="general">
                                    <span>General Discussion</span>
                                </label>
                            </div>
                        </div>

                        <div class="filter-checkboxes">
                            <label class="filter-option">
                                <input type="checkbox" name="myPosts">
                                <span>My Posts</span>
                            </label>
                            <label class="filter-option">
                                <input type="checkbox" name="likedPosts">
                                <span>Liked Posts</span>
                            </label>
                        </div>

                        <button type="submit">Apply Filters</button>
                    </form>
                </div>

                <div class="post-section create-section">
                    <form method="POST" action="/post/create">
                        <!-- Error Popout for post creation -->
                        <!-- {{if .form_error}}
                        <input type="checkbox" id="error-create-post" class="error-toggle" checked hidden>
                        <div class="error-popout">
                            <label for="error-create-post" class="error-close">x</label>
                            <p class="error-message">{{.form_error}}</p>
                        </div>
                        {{end}} -->
                        {{if .form_error}}
                        <textarea name="content" placeholder="Write your post..." required
                            maxlength="500">{{.Post.Content}}</textarea>
                        {{else}}
                        <textarea name="content" placeholder="Write your post..." required maxlength="500"></textarea>
                        {{end}}

                        <h4>Select Categories:</h4>
                        <div class="category-options">
                            <label class="category-tag">
                                <input type="checkbox" name="categories" value="technology">
                                <span>Technology</span>
                            </label>
                            <label class="category-tag">
                                <input type="checkbox" name="categories" value="gaming">
                                <span>Gaming</span>
                            </label>
                            <label class="category-tag">
                                <input type="checkbox" name="categories" value="science">
                                <span>Science</span>
                            </label>
                            <label class="category-tag">
                                <input type="checkbox" name="categories" value="art & creativity">
                                <span>Art & Creativity</span>
                            </label>
                            <label class="category-tag">
                                <input type="checkbox" name="categories" value="general">
                                <span>General</span>
                            </label>
                        </div>
                        <button type="submit">Post</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Published Posts Section -->

        <section class="posts-container">
            <h2 class="posts-title">Published Posts</h2>

            {{if .}}
            {{range .posts}}
            <article class="forum-post">
                <div class="post-header">
                    <span class="post-author">Posted by {{.Author.UserName}}</span>
                    <span class="post-date">{{.CreatedAt.Format "Jan 02, 2006 15:04"}}</span>
                </div>
                <div class="post-content">{{.Content}}</div>

                <div class="post-footer">
                    <div class="post-categories">
                        {{range .Categories}}
                        <span class="category-badge">{{.Name}}</span>
                        {{end}}
                    </div>
                    <div class="post-stats">
                        <span class="likes">üëç {{.LikeCount}}</span>
                        <span class="dislikes">üëé {{.DislikeCount}}</span>
                        <span class="comments">üí¨ {{len .Comments}} comments</span>
                    </div>
                </div>
            </article>
            {{end}}
            {{else}}
            <p>No posts available.</p>
            {{end}}
        </section>
    </main>
</body>

</html>